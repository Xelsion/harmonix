<?php
global $lang;

$this->set("title", "Rolle bearbeiten");
$role = $this->get("role");
$role_option = $this->get("option_list");
?>
<h1>Rolle bearbeiten</h1>
<div class="container-fluid">
	<form action="/actor-roles/<?= $role->id ?>" method="POST" class="needs-validation" novalidate>
		<div class="form-group">
			<label for="name">Name</label>
			<input type="text" name="name" value="<?= escaped_html($role->name) ?>" id="name" required />
			<div class="invalid-feedback"><?= escaped_html($lang["required"]["name"]) ?></div>
		</div>
		<div class="form-group">
			<label for="child_of">Unterrolle von</label>
			<select name="child_of" id="child_of">
				<option value="">- keine -</option>
				<?php foreach( $role_option as $parent ) { ?>
					<?php if( !$role->isAncestorOf($parent) ) { ?>
						<option value="<?= $parent->id ?>"<?= ( $role->child_of === $parent->id ) ? ' selected' : '' ?>><?= escaped_html($parent->name) ?></option>
					<?php } ?>
				<?php } ?>
			</select>
		</div>
		<table>
			<tr class="table-row">
				<td class="table-col align-top">
					<div>Rechte: Alles</div>
				</td>
				<td class="table-col align-top">
					<div class="clearfix">
						<input type="checkbox" name="all[read]" value="x" id="all_read"
						       class="form-check-input float-start"<?= ( $role->canReadALl() ) ? ' checked' : '' ?> />
						<label for="all_read"
						       class="form-check-label float-end"><?= escaped_html($lang["read"]) ?></label>
					</div>
					<div class="clearfix">
						<input type="checkbox" name="all[create]" value="x" id="all_create"
						       class="form-check-input float-start"<?= ( $role->canCreateALl() ) ? ' checked' : '' ?> />
						<label for="all_create"
						       class="form-check-label float-end"><?= escaped_html($lang["create"]) ?></label>
					</div>
					<div class="clearfix">
						<input type="checkbox" name="all[update]" value="x" id="all_update"
						       class="form-check-input float-start"<?= ( $role->canUpdateALl() ) ? ' checked' : '' ?> />
						<label for="all_update"
						       class="form-check-label float-end"><?= escaped_html($lang["update"]) ?></label>
					</div>
					<div class="clearfix">
						<input type="checkbox" name="all[delete]" value="x" id="all_delete"
						       class="form-check-input float-start"<?= ( $role->canDeleteALl() ) ? ' checked' : '' ?> />
						<label for="all_delete"
						       class="form-check-label float-end"><?= escaped_html($lang["delete"]) ?></label>
					</div>
				</td>
			</tr>
			<tr class="table-row">
				<td class="table-col align-top">
					<div>Rechte: Gruppe</div>
					<div class="text-nowrap">(incl. Untergruppen)</div>
				</td>
				<td class="table-col align-top">
					<div class="clearfix">
						<input type="checkbox" name="group[read]" value="x" id="group_read"
						       class="form-check-input float-start"<?= ( $role->canReadGroup() ) ? ' checked' : '' ?> />
						<label for="group_read"
						       class="form-check-label float-end"><?= escaped_html($lang["read"]) ?></label>
					</div>
					<div class="clearfix">
						<input type="checkbox" name="group[create]" value="x" id="group_create"
						       class="form-check-input float-start"<?= ( $role->canCreateGroup() ) ? ' checked' : '' ?> />
						<label for="group_create"
						       class="form-check-label float-end"><?= escaped_html($lang["create"]) ?></label>
					</div>
					<div class="clearfix">
						<input type="checkbox" name="group[update]" value="x" id="group_update"
						       class="form-check-input float-start"<?= ( $role->canUpdateGroup() ) ? ' checked' : '' ?> />
						<label for="group_update"
						       class="form-check-label float-end"><?= escaped_html($lang["update"]) ?></label>
					</div>
					<div class="clearfix">
						<input type="checkbox" name="group[delete]" value="x" id="group_delete"
						       class="form-check-input float-start"<?= ( $role->canDeleteGroup() ) ? ' checked' : '' ?> />
						<label for="group_delete"
						       class="form-check-label float-end"><?= escaped_html($lang["delete"]) ?></label>
					</div>
				</td>
			</tr>
			<tr class="table-row">
				<td class="table-col align-top">
					<div>Rechte: Eigene</div>
				</td>
				<td class="table-col align-top">
					<div class="clearfix">
						<input type="checkbox" name="own[read]" value="x" id="own_read"
						       class="form-check-input float-start"<?= ( $role->canReadOwn() ) ? ' checked' : '' ?> />
						<label for="own_read"
						       class="form-check-label float-end"><?= escaped_html($lang["read"]) ?></label>
					</div>
					<div class="clearfix">
						<input type="checkbox" name="own[create]" value="x" id="own_create"
						       class="form-check-input float-start"<?= ( $role->canCreateOwn() ) ? ' checked' : '' ?> />
						<label for="own_create"
						       class="form-check-label float-end"><?= escaped_html($lang["create"]) ?></label>
					</div>
					<div class="clearfix">
						<input type="checkbox" name="own[update]" value="x" id="own_update"
						       class="form-check-input float-start"<?= ( $role->canUpdateOwn() ) ? ' checked' : '' ?> />
						<label for="own_update"
						       class="form-check-label float-end"><?= escaped_html($lang["update"]) ?></label>
					</div>
					<div class="clearfix">
						<input type="checkbox" name="own[delete]" value="x" id="own_delete"
						       class="form-check-input float-start"<?= ( $role->canDeleteOwn() ) ? ' checked' : '' ?> />
						<label for="own_delete"
						       class="form-check-label float-end"><?= escaped_html($lang["delete"]) ?></label>
					</div>
				</td>
			</tr>
		</table>

		<div class="form-group clearfix">
			<button type="submit" name="cancel" class="cancel float-start"><?= escaped_html($lang["cancel"]) ?></button>
			<button type="submit" name="update" class="submit float-end"><?= escaped_html($lang["save"]) ?></button>
		</div>
	</form>
</div>
